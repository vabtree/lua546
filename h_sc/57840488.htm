<html>
<head>
<!-- This html document was created by Imagix 4D -->
<link href="../htm/symbol.css" rel="stylesheet" type="text/css">
<link href="../htm/symcolors.css" rel="stylesheet" type="text/css">
<link href="../htm/notebook.css" rel="stylesheet" type="text/css">
<base target="symbol">
</head>
<body>

<h2>lfunc.c</h2>

<div class="notebook">
<ul>
<li><a href="../h_aa/57840488.htm" class="file" target="_self">Info</a></li>
<li><a href="../h_im/57840488.htm" class="file" target="_self">Global Interface</a></li>
<li><a href="../h_rx/57840488.htm" class="file" target="_self">File Inclusion</a></li>
<li><a href="../h_nm/57840488.htm" class="file" target="_self">Internals</a></li>
<li><a href="../h_uf/57840488.htm" class="file" target="_self">Use of Elements</a></li>
<li><a href="../h_df/57840488.htm" class="file" target="_self">Dependencies</a></li>
<li id="current"><a href="../h_src/57840488.htm" class="file" target="_self">Source Code</a></li>
</ul>
</div>
<div class="notebook">
<ul>
<li><a href="../h_src/57840488.htm" class="file" target="_self">Source Code</a></li>
<li id="current"><a href="../h_sc/57840488.htm" class="file" target="_self">Source Checks</a></li>
</ul>
</div>
<div class="nb_clear">
</div>
<h4>Source Checks  <a class="legend">(see key)</a></h4>
<table cellpadding=0 cellspacing=0 border=0>
<tr><td>total instances:</td><td class=mtrc>51</td></tr>
<tr><td>total checks involved:</td><td class=mtrc>4</td></tr>
<tr><td>total lines  involved:</td><td class=mtrc>49</td></tr>
<tr><th></th></tr>
</table>
<pre>
</pre>
<h5>Number of Built-In Operators</h5>
<pre>
    56 :    <a href="../h_src/57621476.htm" class="macro">luaC_objbarrier</a>(<a href="../h_src/57839060.htm" class="localvar">L</a>, <a href="../h_src/57838924.htm" class="localvar">cl</a>, <a href="../h_src/57838516.htm" class="localvar">uv</a>);
   170 :    if (<a href="../h_src/57529400.htm" class="macro">l_isfalse</a>(<a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57833076.htm" class="localvar">level</a>)))
   204 :    <a href="../h_src/57621340.htm" class="macro">luaC_barrier</a>(<a href="../h_src/57832804.htm" class="localvar">L</a>, <a href="../h_src/57832532.htm" class="localvar">uv</a>, <a href="../h_src/57832260.htm" class="localvar">slot</a>);
</pre>
<pre>
</pre>
<h5>Unclear Subexpression</h5>
<pre>
    53 :    <a href="../h_src/57838516.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57510564.htm" class="variable">v</a>.<a href="../h_src/57510768.htm" class="variable">p</a> = &amp;<a href="../h_src/57838516.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509816.htm" class="variable">value</a>;  <a  class="comments">/* make it closed */</a>
    69 :    <a href="../h_src/57837700.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57510564.htm" class="variable">v</a>.<a href="../h_src/57510768.htm" class="variable">p</a> = <a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57838108.htm" class="localvar">level</a>);  <a  class="comments">/* current value lives in the stack */</a>
    73 :    <a href="../h_src/57837564.htm" class="localvar">next</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510020.htm" class="variable">previous</a> = &amp;<a href="../h_src/57837700.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510224.htm" class="variable">next</a>;
    88 :    <a href="../h_src/57509612.htm" class="type">UpVal</a> **<a href="../h_src/57837156.htm" class="localvar">pp</a> = &amp;<a href="../h_src/57837428.htm" class="localvar">L</a>-&gt;<a href="../h_src/57642216.htm" class="variable">openupval</a>;
    95 :    <a href="../h_src/57837156.htm" class="localvar">pp</a> = &amp;<a href="../h_src/57837020.htm" class="localvar">p</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510224.htm" class="variable">next</a>;
   110 :    <a href="../h_src/57533412.htm" class="macro">setobj2s</a>(<a href="../h_src/57836748.htm" class="localvar">L</a>, <a href="../h_src/57836204.htm" class="localvar">top</a>, <a href="../h_src/57836068.htm" class="localvar">tm</a>);  <a  class="comments">/* will call metamethod... */</a>
   111 :    <a href="../h_src/57533412.htm" class="macro">setobj2s</a>(<a href="../h_src/57836748.htm" class="localvar">L</a>, <a href="../h_src/57836204.htm" class="localvar">top</a> + 1, <a href="../h_src/57836612.htm" class="localvar">obj</a>);  <a  class="comments">/* with 'self' as the 1st argument */</a>
   112 :    <a href="../h_src/57533412.htm" class="macro">setobj2s</a>(<a href="../h_src/57836748.htm" class="localvar">L</a>, <a href="../h_src/57836204.htm" class="localvar">top</a> + 2, <a href="../h_src/57836476.htm" class="localvar">err</a>);  <a  class="comments">/* and error msg. as 2nd argument */</a>
   126 :    const <a href="../h_src/57535384.htm" class="type">TValue</a> *<a href="../h_src/57834708.htm" class="localvar">tm</a> = <a href="../h_src/57498052.htm" class="function">luaT_gettmbyobj</a>(<a href="../h_src/57834980.htm" class="localvar">L</a>, <a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57834844.htm" class="localvar">level</a>), <a href="../h_src/57499276.htm" class="variable">TM_CLOSE</a>);
   144 :    <a href="../h_src/57535384.htm" class="type">TValue</a> *<a href="../h_src/57833620.htm" class="localvar">uv</a> = <a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57834028.htm" class="localvar">level</a>);  <a  class="comments">/* value being closed */</a>
   147 :    <a href="../h_src/57833484.htm" class="localvar">errobj</a> = &amp;<a href="../h_src/57641196.htm" class="macro">G</a>(<a href="../h_src/57834164.htm" class="localvar">L</a>)-&gt;<a href="../h_src/57646228.htm" class="variable">nilvalue</a>;  <a  class="comments">/* error object is nil */</a>
   149 :    <a href="../h_src/57833484.htm" class="localvar">errobj</a> = <a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57834028.htm" class="localvar">level</a> + 1);  <a  class="comments">/* error object goes after 'uv' */</a>
   170 :    if (<a href="../h_src/57529400.htm" class="macro">l_isfalse</a>(<a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57833076.htm" class="localvar">level</a>)))
   184 :    *<a href="../h_src/57832940.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510020.htm" class="variable">previous</a> = <a href="../h_src/57832940.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510224.htm" class="variable">next</a>;
   197 :    <a href="../h_src/57535384.htm" class="type">TValue</a> *<a href="../h_src/57832260.htm" class="localvar">slot</a> = &amp;<a href="../h_src/57832532.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509816.htm" class="variable">value</a>;  <a  class="comments">/* new position for value */</a>
</pre>
<pre>
</pre>
<h5>Conversion Issue</h5>
<pre>
    29 :    <a href="../h_src/57508728.htm" class="type">CClosure</a> *<a href="../h_src/57839740.htm" class="localvar">c</a> = <a href="../h_src/57639700.htm" class="macro">gco2ccl</a>(<a href="../h_src/57839876.htm" class="localvar">o</a>);
    30 :    <a href="../h_src/57839740.htm" class="localvar">c</a>-&gt;<a href="../h_src/57509068.htm" class="variable">nupvalues</a> = <a href="../h_src/57546944.htm" class="macro">cast_byte</a>(<a href="../h_src/57840012.htm" class="localvar">nupvals</a>);
    37 :    <a href="../h_src/57507980.htm" class="type">LClosure</a> *<a href="../h_src/57839196.htm" class="localvar">c</a> = <a href="../h_src/57639836.htm" class="macro">gco2lcl</a>(<a href="../h_src/57839332.htm" class="localvar">o</a>);
    39 :    <a href="../h_src/57839196.htm" class="localvar">c</a>-&gt;<a href="../h_src/57508320.htm" class="variable">nupvalues</a> = <a href="../h_src/57546944.htm" class="macro">cast_byte</a>(<a href="../h_src/57839468.htm" class="localvar">nupvals</a>);
    52 :    <a href="../h_src/57509612.htm" class="type">UpVal</a> *<a href="../h_src/57838516.htm" class="localvar">uv</a> = <a href="../h_src/57639020.htm" class="macro">gco2upv</a>(<a href="../h_src/57838652.htm" class="localvar">o</a>);
    54 :    <a href="../h_src/57530896.htm" class="macro">setnilvalue</a>(<a href="../h_src/57838516.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57510564.htm" class="variable">v</a>.<a href="../h_src/57510768.htm" class="variable">p</a>);
    56 :    <a href="../h_src/57621476.htm" class="macro">luaC_objbarrier</a>(<a href="../h_src/57839060.htm" class="localvar">L</a>, <a href="../h_src/57838924.htm" class="localvar">cl</a>, <a href="../h_src/57838516.htm" class="localvar">uv</a>);
    56 :    <a href="../h_src/57621476.htm" class="macro">luaC_objbarrier</a>(<a href="../h_src/57839060.htm" class="localvar">L</a>, <a href="../h_src/57838924.htm" class="localvar">cl</a>, <a href="../h_src/57838516.htm" class="localvar">uv</a>);
    67 :    <a href="../h_src/57509612.htm" class="type">UpVal</a> *<a href="../h_src/57837700.htm" class="localvar">uv</a> = <a href="../h_src/57639020.htm" class="macro">gco2upv</a>(<a href="../h_src/57837836.htm" class="localvar">o</a>);
    91 :    while ((<a href="../h_src/57837020.htm" class="localvar">p</a> = *<a href="../h_src/57837156.htm" class="localvar">pp</a>) != NULL &amp;&amp; <a href="../h_src/57631404.htm" class="macro">uplevel</a>(<a href="../h_src/57837020.htm" class="localvar">p</a>) &gt;= <a href="../h_src/57837292.htm" class="localvar">level</a>) {  <a  class="comments">/* search for it */</a>
    93 :    if (<a href="../h_src/57631404.htm" class="macro">uplevel</a>(<a href="../h_src/57837020.htm" class="localvar">p</a>) == <a href="../h_src/57837292.htm" class="localvar">level</a>)  <a  class="comments">/* corresponding upvalue? */</a>
   173 :    while (<a href="../h_src/57547080.htm" class="macro">cast_uint</a>(<a href="../h_src/57833076.htm" class="localvar">level</a> - <a href="../h_src/57833212.htm" class="localvar">L</a>-&gt;<a href="../h_src/57532324.htm" class="variable">tbclist</a>.<a href="../h_src/57531984.htm" class="variable">p</a>) &gt; <a href="../h_src/57833348.htm" class="macro">MAXDELTA</a>) {
   177 :    <a href="../h_src/57833076.htm" class="localvar">level</a>-&gt;<a href="../h_src/57532324.htm" class="variable">tbclist</a>.<a href="../h_src/57532460.htm" class="variable">delta</a> = <a href="../h_src/57547760.htm" class="macro">cast</a>(unsigned short, <a href="../h_src/57833076.htm" class="localvar">level</a> - <a href="../h_src/57833212.htm" class="localvar">L</a>-&gt;<a href="../h_src/57642148.htm" class="variable">tbclist</a>.<a href="../h_src/57531984.htm" class="variable">p</a>);
   196 :    while ((<a href="../h_src/57832532.htm" class="localvar">uv</a> = <a href="../h_src/57832804.htm" class="localvar">L</a>-&gt;<a href="../h_src/57642216.htm" class="variable">openupval</a>) != NULL &amp;&amp; (<a href="../h_src/57832396.htm" class="localvar">upl</a> = <a href="../h_src/57631404.htm" class="macro">uplevel</a>(<a href="../h_src/57832532.htm" class="localvar">uv</a>)) &gt;= <a href="../h_src/57832668.htm" class="localvar">level</a>) {
   203 :    <a href="../h_src/57625284.htm" class="macro">nw2black</a>(<a href="../h_src/57832532.htm" class="localvar">uv</a>);  <a  class="comments">/* closed upvalues cannot be gray */</a>
   204 :    <a href="../h_src/57621340.htm" class="macro">luaC_barrier</a>(<a href="../h_src/57832804.htm" class="localvar">L</a>, <a href="../h_src/57832532.htm" class="localvar">uv</a>, <a href="../h_src/57832260.htm" class="localvar">slot</a>);
   204 :    <a href="../h_src/57621340.htm" class="macro">luaC_barrier</a>(<a href="../h_src/57832804.htm" class="localvar">L</a>, <a href="../h_src/57832532.htm" class="localvar">uv</a>, <a href="../h_src/57832260.htm" class="localvar">slot</a>);
   228 :    <a href="../h_aa/57441872.htm" class="type">ptrdiff_t</a> <a href="../h_src/57830900.htm" class="localvar">levelrel</a> = <a href="../h_src/57634396.htm" class="macro">savestack</a>(<a href="../h_src/57831444.htm" class="localvar">L</a>, <a href="../h_src/57831308.htm" class="localvar">level</a>);
   228 :    <a href="../h_aa/57441872.htm" class="type">ptrdiff_t</a> <a href="../h_src/57830900.htm" class="localvar">levelrel</a> = <a href="../h_src/57634396.htm" class="macro">savestack</a>(<a href="../h_src/57831444.htm" class="localvar">L</a>, <a href="../h_src/57831308.htm" class="localvar">level</a>);
   234 :    <a href="../h_src/57831308.htm" class="localvar">level</a> = <a href="../h_src/57634260.htm" class="macro">restorestack</a>(<a href="../h_src/57831444.htm" class="localvar">L</a>, <a href="../h_src/57830900.htm" class="localvar">levelrel</a>);
   234 :    <a href="../h_src/57831308.htm" class="localvar">level</a> = <a href="../h_src/57634260.htm" class="macro">restorestack</a>(<a href="../h_src/57831444.htm" class="localvar">L</a>, <a href="../h_src/57830900.htm" class="localvar">levelrel</a>);
   242 :    <a href="../h_src/57513828.htm" class="type">Proto</a> *<a href="../h_src/57830356.htm" class="localvar">f</a> = <a href="../h_src/57639292.htm" class="macro">gco2p</a>(<a href="../h_src/57830492.htm" class="localvar">o</a>);
</pre>
<pre>
</pre>
<h5>Needs Compound Statement</h5>
<pre>
    40 :    while (<a href="../h_src/57839468.htm" class="localvar">nupvals</a>--) <a href="../h_src/57839196.htm" class="localvar">c</a>-&gt;<a href="../h_src/57508048.htm" class="variable">upvals</a>[<a href="../h_src/57839468.htm" class="localvar">nupvals</a>] = NULL;
    72 :    if (<a href="../h_src/57837564.htm" class="localvar">next</a>)
    73 :    <a href="../h_src/57837564.htm" class="localvar">next</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510020.htm" class="variable">previous</a> = &amp;<a href="../h_src/57837700.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510224.htm" class="variable">next</a>;
    93 :    if (<a href="../h_src/57631404.htm" class="macro">uplevel</a>(<a href="../h_src/57837020.htm" class="localvar">p</a>) == <a href="../h_src/57837292.htm" class="localvar">level</a>)  <a  class="comments">/* corresponding upvalue? */</a>
    94 :    return <a href="../h_src/57837020.htm" class="localvar">p</a>;  <a  class="comments">/* return it */</a>
   114 :    if (<a href="../h_src/57836340.htm" class="localvar">yy</a>)
   115 :    <a href="../h_src/57633240.htm" class="function">luaD_call</a>(<a href="../h_src/57836748.htm" class="localvar">L</a>, <a href="../h_src/57836204.htm" class="localvar">top</a>, 0);
   116 :    else
   117 :    <a href="../h_src/57633172.htm" class="function">luaD_callnoyield</a>(<a href="../h_src/57836748.htm" class="localvar">L</a>, <a href="../h_src/57836204.htm" class="localvar">top</a>, 0);
   130 :    if (<a href="../h_src/57834436.htm" class="localvar">vname</a> == NULL) <a href="../h_src/57834436.htm" class="localvar">vname</a> = &quot;?&quot;;
   146 :    if (<a href="../h_src/57833892.htm" class="localvar">status</a> == <a href="../h_src/57631132.htm" class="macro">CLOSEKTOP</a>)
   147 :    <a href="../h_src/57833484.htm" class="localvar">errobj</a> = &amp;<a href="../h_src/57641196.htm" class="macro">G</a>(<a href="../h_src/57834164.htm" class="localvar">L</a>)-&gt;<a href="../h_src/57646228.htm" class="variable">nilvalue</a>;  <a  class="comments">/* error object is nil */</a>
   170 :    if (<a href="../h_src/57529400.htm" class="macro">l_isfalse</a>(<a href="../h_src/57531712.htm" class="macro">s2v</a>(<a href="../h_src/57833076.htm" class="localvar">level</a>)))
   171 :    return;  <a  class="comments">/* false doesn't need to be closed */</a>
   185 :    if (<a href="../h_src/57832940.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510224.htm" class="variable">next</a>)
   186 :    <a href="../h_src/57832940.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510224.htm" class="variable">next</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510020.htm" class="variable">previous</a> = <a href="../h_src/57832940.htm" class="localvar">uv</a>-&gt;<a href="../h_src/57509680.htm" class="variable">u</a>.<a href="../h_src/57509884.htm" class="variable">open</a>.<a href="../h_src/57510020.htm" class="variable">previous</a>;
   217 :    while (<a href="../h_src/57831580.htm" class="localvar">tbc</a> &gt; <a href="../h_src/57831716.htm" class="localvar">L</a>-&gt;<a href="../h_src/57642284.htm" class="variable">stack</a>.<a href="../h_src/57531984.htm" class="variable">p</a> &amp;&amp; <a href="../h_src/57831580.htm" class="localvar">tbc</a>-&gt;<a href="../h_src/57532324.htm" class="variable">tbclist</a>.<a href="../h_src/57532460.htm" class="variable">delta</a> == 0)
   218 :    <a href="../h_src/57831580.htm" class="localvar">tbc</a> -= <a href="../h_src/57833348.htm" class="macro">MAXDELTA</a>;  <a  class="comments">/* remove dummy nodes */</a>
   288 :    if (<a href="../h_src/57829812.htm" class="localvar">local_number</a> == 0)
   289 :    return <a href="../h_src/57522668.htm" class="macro">getstr</a>(<a href="../h_src/57829948.htm" class="localvar">f</a>-&gt;<a href="../h_src/57514032.htm" class="variable">locvars</a>[<a href="../h_src/57829540.htm" class="localvar">i</a>].<a href="../h_src/57516888.htm" class="variable">varname</a>);
</pre>
<pre>

</pre>
</body>
</html>

